{template './common/siteheader'}
<style type="text/css">
    .layui-form-label{
        white-space: nowrap;
        width: auto!important;
        padding: 9px 0!important;
    }
    .inputBox{
        display: flex;
        flex-wrap: wrap;
        /*justify-content: center;*/
        /*align-items: center;*/
    }
    .inputBox label{
        display: none;
        padding: 0 20px 0 0!important;
    }
    .inputBox label div{
        margin: 5px 0;
    }
    .layui-input-block {
        margin-left: 88px!important;
    }
    .layui-form-radio{
        margin: 0!important;
    }
    .contentpanel{
        float: right;
        width: 87%;
        margin-right: 1%;
    }

</style>
</div>
<div class="contentpanel">
        <ul class="nav nav-tabs patient-tabs J-panel-tabs">
            <li class="J-module-control " data-permission="8">
                <a  href="{php echo $this->copysiteurl('setting.wuzi')}" ><strong>医生列表</strong></a>
            </li>
            <li class="J-module-control active" data-permission="10">
                <a href="{php echo $this->copysiteurl('setting.wuzi')}" ><strong>添加医生</strong></a>
            </li>
        </ul>
       <form id="addFollowForm" method="post" action="" class="layui-form">
            <input type="hidden" class="J-id" name="followupId" value="3225">
            <input type="hidden" class="J-type" name="operaType" value="1">
            <div class="panel panel-default">
                <div class="panel-heading bgfc pt20">
                    <h4 class="panel-title">专家详情</h4>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-9 col-md-10">
                            <div class="row">
                                 <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">绑定微信 <span class="asterisk">*</span></label>
                                    <select class="form-control input-sm mt0 J-listener" id="j_selectNation" data-placeholder="请选择"  name="openid">
                                        <option value="">请选择</option>
                                        {loop $all_user $item} 
                                        <option  value="{$item['openid']}" {if $item['openid'] == $rew['openid'] } selected="selected" {/if}>{$item['u_name']}</option>
                                        {/loop}
                                    </select>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group pos-relative">
                                        <label class="control-label">专家姓名 <span class="asterisk" >*</span></label>
                                        <div class="form-group">
                                            <input type="text" class="form-control J-name"  value="{$rew['z_name']}" required="" autocomplete="off" name="z_name">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">性别 <span class="asterisk">*</span></label>
                                        <div class="row mt10">
                                            <div class="col-xs-3 col-sm-4 col-pad-sm">
                                                <div class="rdio-default">
                                                    <input type="radio" class="J-sex_code" name="z_sex" id="radioDefault1" value="1" {if $rew['z_sex'] =='1'} checked="checked" {/if}   >
                                                    <label for="radioDefault1">男</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-3 col-sm-4 col-pad-sm">
                                                <div class="rdio-default">
                                                    <input type="radio" class="J-sex_code" name="z_sex" id="radioDefault2" {if $rew['z_sex'] =='2'} checked="checked" {/if} value="2"  >
                                                    <label for="radioDefault2">女</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
 

                            </div>
                            <div class="row">
                                 <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">身份证号<span class="asterisk">*</span></label>
                                        <input type="text" value="{$rew['sfzbianhao']}" name="sfzbianhao" class="form-control J-address" required="">
                                    </div>
                                </div>  
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">手机号<span class="asterisk">*</span></label>
                                        <input type="number" value="{$rew['z_telephone']}" name="z_telephone" class="form-control cellphone J-mobilenumber" required="">

                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">工作时间<span class="asterisk">*</span></label>
                                        <input type="text" value="{$rew['goby']}" name="goby" class="form-control isPid J-id_no" required="">
                                    </div>
                                </div>  

                            </div>

                       
                            <div class="row">
                                  <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">擅长/标签 <span class="asterisk">*</span></label>
                                        <input type="text" value="{$rew['z_zhenzhi']}" name="z_zhenzhi" class="form-control J-address" required="">
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">职称<span class="asterisk">*</span></label>
                                        <input type="text" value="{$rew['z_zhicheng']}" name="z_zhicheng" class="form-control J-job_name" required="">
                                    </div>
                                </div>
                                
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">帮助人数</label>
                                        <input type="text" value="{$rew['z_yy_fens']}" name="z_yy_fens" class="form-control J-company" >
                                    </div>
                                </div>
                            </div>
                            <div class="row">

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">专家职务<span class="asterisk">*</span></label>
                                        <input type="text" value="{$rew['z_zhiwu']}" name="z_zhiwu" class="form-control J-city_name" required="">
                                    </div>
                                </div> 
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">图文咨询金额</label>
                                        <input type="text" value="{$rew['twzixun']}" name="twzixun" class="form-control J-address" >
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">免费追问次数</label>
                                        <input type="text" value="{$rew['zhuiwen']}" name="zhuiwen" class="form-control J-province_name" >
                                    </div>
                                </div>
                            </div>
                            <div class="row">

                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">快速问诊金额</label>
                                        <input type="text" value="{$rew['wzmoney']}" name="wzmoney" class="form-control J-address" >
                                    </div>
                                </div>
                                  <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="control-label">预约金额</label>
                                        <input type="text" value="{$rew['z_yy_money']}" name="z_yy_money" class="form-control J-address" >
                                    </div>
                                </div>
                                 <div class="col-sm-4">
                                 <div class="form-group">
                                    <div  class="control-label" >科室<span class="asterisk">*</span></div>
                                    <div class="form-controls col-sm-10">
                                        <div class="row row-fix tpl-category-container" ><div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                        <select name="pid" class="form-control tpl-category-parent we7-select"  onchange="checkAAA(this.value);">
                                               <option value="" >请选择一级分类</option>
                                            {loop $subcatess $item} 
                                               <option value="{$item['id']}" {if $item['id']==$rew['z_room']}selected{/if}>{$item['name']}</option>
                                            {/loop}
                                            </select>
                                          </div>
                                          <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                          <select name="floor" id="floor"  class="form-control tpl-category-child we7-select">{$o}</select>
                                          </div>
                                        </div>
                                      </div>
                                   </div>
                                </div>
                            </div>
                            <script type="text/javascript">
                              
                                function checkAAA(id) {
                                   var url ="{php echo $this->createWeburl('setting',array('op'=>'cateary'));}"; 
                                    $.ajax({  
                                        type: "POST",  
                                        url: url,  
                                        dataType: "json",  
                                        data: {"id":id},  
                                        cache: false,
                                        success: function(jsonStr){  
                                        $("#floor").html('<option value="">请选择二级分类</option>');
                                        for ( var i in jsonStr) {
                                            $("#floor").append(
                                                    "<option value='"+jsonStr[i].id+"'>"
                                                            + jsonStr[i].name + "</option>");
                                        } 
                                      }
                                    });

                                }
                            </script> 
                               <link rel="stylesheet" href="{php echo HYB_YL_ADMIN}/layui/css/layui.css">

                               <div class="layui-form-item">
                                <label class="layui-form-label">开通服务</label>
                                <div class="layui-input-block">
                                   {loop $menu_list $key $item} 
                                    <input type="checkbox" name="like[{$item['pinyin']}]" title="{$item['name']}"  lay-filter="table1" value="{$item['sid']}" data-index='{$key}' {if in_array($item['sid'],$rew['sid'])}checked="checked"{/if} >
                                   {/loop}
                                   <input type="hidden" name="sid" value="{$rew['sid']}" id="fuwuBox">
                                </div>
                              </div>
                              <div class="inputBox">
                              {loop $menu_list $key $item}
                              <?php $money_one=$item['pinyin']; ?>
                                <label class="col-sm-4" {if in_array($item['sid'],$rew['sid'])} style="display:block;" {/if} >
                                    <div>{$item['name']}金额</div>
                                    <input data-index='{$key}'  type="text" name="money[{$item['pinyin']}]" class="form-control"  {if array_key_exists($money_one,$money)} value="{$money[$money_one]}" {/if}
                                    >
                                </label>
                              {/loop}
                              </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group" position="relative">
                                        <div class="row mb10">
                                            <div class="col-xs-6 col-sm-8 col-md-8">
                                                <label class="control-label">专家介绍 <span class="asterisk">*</span></label>
                                            </div>
                                        </div> 
                                        <textarea name="z_content" value="" placeholder="填写医生介绍..." class="J-followupContent form-control" rows="5" maxlength="3000">{$rew['z_content']} </textarea>
                                    <div class="J-limitFontNum" style="position:absolute; right: 10px; bottom:-10px;">/3000</div></div>
                                </div>
                            </div>
                            
                        </div>
                        <div class="col-sm-3 col-md-2">
                         <div class="row">
                            <div >{php echo WebCommon::tpl_form_field_image('z_thumbs',$rew['z_thumbs'])}</div>
                         </div>

                        </div>
                    </div>
                </div>
                
                <div class="panel-footer panel-btn-col2">
                    <input name="token" type="hidden" value="{$_W['token']}" />
                    <button type="submit" class="layui-btn" >保存</button>

                </div>
               
            </div>
            
        </form>
                    <!-- 患者信息 -->
 </div>
    
<script src="{php echo HYB_YL_ADMIN}/layui/layui.js"></script>
<script>
layui.use(['form', 'layedit', 'laydate'], function(){
  var form = layui.form
  ,layer = layui.layer
  ,layedit = layui.layedit
  ,laydate = layui.laydate;
  

  //监听提交
  form.on('submit(demo1)', function(data){
    layer.alert(JSON.stringify(data.field), {
      title: '最终的提交信息'
    })
    return false;
  });
 
  //表单赋值
  layui.$('#LAY-component-form-setval').on('click', function(){
    form.val('example', {
      "username": "贤心" // "name": "value"
      ,"password": "123456"
      ,"interest": 1
      ,"like[write]": true //复选框选中状态
      ,"close": true //开关状态
      ,"sex": "女"
      ,"desc": "我爱 layui"
    });
  });
  
  //表单取值
  layui.$('#LAY-component-form-getval').on('click', function(){
    var data = form.val('example');
  });
  var inputArr=$('#fuwuBox').val()
  var inputArr=inputArr.split(',')
  console.log(inputArr)
  form.on('checkbox(table1)', function(data){
  console.log(data.elem); //得到checkbox原始DOM对象
  console.log(data.elem.checked); //是否被选中，true或者false
  console.log(data.value); //复选框value值，也可以通过data.elem.value得到
  console.log(data.othis); //得到美化后的DOM对象
  // console.log($(data.elem).val())
  if(data.elem.checked){
    inputArr.push($(data.elem).val())
  $('.inputBox').find('label').eq($(data.elem).attr('data-index')).css({display:'block'})
  console.log(inputArr)
  $('#fuwuBox').val(inputArr)
  }else{
    for(var i=0;i<inputArr.length;i++){
        if($(data.elem).val()==inputArr[i]){
            inputArr.splice(i,1)
        }
    }
  $('#fuwuBox').val(inputArr)
  $('.inputBox').find('label').eq($(data.elem).attr('data-index')).css({display:'none'})
  }
  
}); 
});
</script>